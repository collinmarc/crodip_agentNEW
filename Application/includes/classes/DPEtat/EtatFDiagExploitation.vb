Public Class EtatFDiagExploitation
    Inherits EtatFDiag

    Public Sub New()
        Etat = EtatFenetre.ETAT_PRELIMINAIRE
    End Sub
    Public Sub New(pEtatFDiag As EtatFDiag)
        MyBase.New(pEtatFDiag)
        frmDiag = GetFrmFromParent(Of controle_preliminaire)(pEtatFDiag)
    End Sub
    Public Sub New(pDiagMode As GlobalsCRODIP.DiagMode, pDiag As Diagnostic, pPulve As Pulverisateur, pExploit As Exploitation, pAgent As Agent)
        MyBase.New(pDiagMode, pDiag, pPulve, pExploit, pAgent)
        frmDiag = GetFrmFromParent(Of fiche_exploitant)()
    End Sub
    Public Overrides Function createFrmDiag() As Form
        Dim oReturn As Form
        oReturn = New fiche_exploitant()
        CType(oReturn, fiche_exploitant).setContexte(True, clientCourant, agentCourant)
        ShowDialog = True
        Return oReturn
    End Function

    Public Overrides Function Action(pAction As ActionFDiag) As EtatFDiag
        Dim oReturn As EtatFDiag = Me
        Select Case pAction.CodeAction
            Case Crodip_agent.Action.ACTION_BACK
                oReturn = Nothing
            Case Crodip_agent.Action.ACTION_NEXT
                oDiag.SetProprietaire(oExploit)
                oReturn = New EtatFDiagPulve(Me)
            Case Crodip_agent.Action.ACTION_RECAP
        End Select
        Return oReturn
    End Function

End Class
