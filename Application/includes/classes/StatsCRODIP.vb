
Public Class StatsCrodip

    Private _NCtrlInspecteurAnnee As Integer
    Private _NCtrlStructureAnnee As Integer
    Private _NCtrlInspecteurTotal As Integer
    Private _NCtrlStructureTotal As Integer

    Private _NCtrl_OK_InspecteurAnnee As Integer
    Private _NCtrl_OK_StructureAnnee As Integer
    Private _NCtrl_OK_InspecteurTotal As Integer
    Private _NCtrl_OK_StructureTotal As Integer
    Private _NCtrl_CP_InspecteurAnnee As Integer
    Private _NCtrl_CP_StructureAnnee As Integer
    Private _NCtrl_CP_InspecteurTotal As Integer
    Private _NCtrl_CP_StructureTotal As Integer
    Private _NCtrl_ReparAvant_InspecteurAnnee As Integer
    Private _NCtrl_ReparAvant_StructureAnnee As Integer
    Private _NCtrl_ReparAvant_InspecteurTotal As Integer
    Private _NCtrl_ReparAvant_StructureTotal As Integer
    Private _NCtrl_AutoControle_InspecteurAnnee As Integer
    Private _NCtrl_AutoControle_StructureAnnee As Integer
    Private _NCtrl_AutoControle_InspecteurTotal As Integer
    Private _NCtrl_AutoControle_StructureTotal As Integer
    Private _NCtrl_PreControle_InspecteurAnnee As Integer
    Private _NCtrl_PreControle_StructureAnnee As Integer
    Private _NCtrl_PreControle_InspecteurTotal As Integer
    Private _NCtrl_PreControle_StructureTotal As Integer




    Sub New()

    End Sub

    Public Property NCtrlInspecteurAnnee As Integer

        Get
            Return _NCtrlInspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrlInspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrlInspecteurTotal As Integer

        Get
            Return _NCtrlInspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrlInspecteurTotal = value

        End Set
    End Property
    Public Property NCtrl_OK_InspecteurAnnee As Integer

        Get
            Return _NCtrl_OK_InspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_OK_InspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrl_OK_InspecteurTotal As Integer

        Get
            Return _NCtrl_OK_InspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_OK_InspecteurTotal = value

        End Set
    End Property
    Public Property NCtrl_CP_InspecteurAnnee As Integer

        Get
            Return _NCtrl_CP_InspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_CP_InspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrl_CP_InspecteurTotal As Integer

        Get
            Return _NCtrl_CP_InspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_CP_InspecteurTotal = value

        End Set
    End Property
    Public Property NCtrl_ReparAvant_InspecteurAnnee As Integer

        Get
            Return _NCtrl_ReparAvant_InspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_ReparAvant_InspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrl_ReparAvant_InspecteurTotal As Integer

        Get
            Return _NCtrl_ReparAvant_InspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_ReparAvant_InspecteurTotal = value

        End Set
    End Property
    Public Property NCtrl_AutoControle_InspecteurAnnee As Integer

        Get
            Return _NCtrl_AutoControle_InspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_AutoControle_InspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrl_AutoControle_InspecteurTotal As Integer

        Get
            Return _NCtrl_AutoControle_InspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_AutoControle_InspecteurTotal = value

        End Set
    End Property
    Public Property NCtrl_PreControle_InspecteurAnnee As Integer

        Get
            Return _NCtrl_PreControle_InspecteurAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_PreControle_InspecteurAnnee = value

        End Set
    End Property
    Public Property NCtrl_PreControle_InspecteurTotal As Integer

        Get
            Return _NCtrl_PreControle_InspecteurTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_PreControle_InspecteurTotal = value

        End Set
    End Property

    Public Property NCtrlStructureAnnee As Integer

        Get
            Return _NCtrlStructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrlStructureAnnee = value

        End Set
    End Property
    Public Property NCtrlStructureTotal As Integer

        Get
            Return _NCtrlStructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrlStructureTotal = value

        End Set
    End Property
    Public Property NCtrl_OK_StructureAnnee As Integer

        Get
            Return _NCtrl_OK_StructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_OK_StructureAnnee = value

        End Set
    End Property
    Public Property NCtrl_OK_StructureTotal As Integer

        Get
            Return _NCtrl_OK_StructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_OK_StructureTotal = value

        End Set
    End Property
    Public Property NCtrl_CP_StructureAnnee As Integer

        Get
            Return _NCtrl_CP_StructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_CP_StructureAnnee = value

        End Set
    End Property
    Public Property NCtrl_CP_StructureTotal As Integer

        Get
            Return _NCtrl_CP_StructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_CP_StructureTotal = value

        End Set
    End Property
    Public Property NCtrl_ReparAvant_StructureAnnee As Integer

        Get
            Return _NCtrl_ReparAvant_StructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_ReparAvant_StructureAnnee = value

        End Set
    End Property
    Public Property NCtrl_ReparAvant_StructureTotal As Integer

        Get
            Return _NCtrl_ReparAvant_StructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_ReparAvant_StructureTotal = value

        End Set
    End Property
    Public Property NCtrl_AutoControle_StructureAnnee As Integer

        Get
            Return _NCtrl_AutoControle_StructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_AutoControle_StructureAnnee = value

        End Set
    End Property
    Public Property NCtrl_AutoControle_StructureTotal As Integer

        Get
            Return _NCtrl_AutoControle_StructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_AutoControle_StructureTotal = value

        End Set
    End Property
    Public Property NCtrl_PreControle_StructureAnnee As Integer

        Get
            Return _NCtrl_PreControle_StructureAnnee

        End Get
        Set(ByVal value As Integer)
            _NCtrl_PreControle_StructureAnnee = value

        End Set
    End Property
    Public Property NCtrl_PreControle_StructureTotal As Integer

        Get
            Return _NCtrl_PreControle_StructureTotal

        End Get
        Set(ByVal value As Integer)
            _NCtrl_PreControle_StructureTotal = value

        End Set
    End Property
    Public ReadOnly Property PctCtrl_OK_InspecteurAnnee As String

        Get
            If _NCtrlInspecteurAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_OK_InspecteurAnnee / _NCtrlInspecteurAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_OK_InspecteurTotal As String

        Get
            If _NCtrlInspecteurTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_OK_InspecteurTotal / _NCtrlInspecteurTotal) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_CP_InspecteurAnnee As String

        Get
            If _NCtrlInspecteurAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_CP_InspecteurAnnee / _NCtrlInspecteurAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_CP_InspecteurTotal As String

        Get
            If _NCtrlInspecteurTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_CP_InspecteurTotal / _NCtrlInspecteurTotal) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_ReparAvant_InspecteurAnnee As String

        Get
            If _NCtrlInspecteurAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_ReparAvant_InspecteurAnnee / _NCtrlInspecteurAnnee) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_ReparAvant_InspecteurTotal As String

        Get
            If _NCtrlInspecteurTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_ReparAvant_InspecteurTotal / _NCtrlInspecteurTotal) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_AutoControle_InspecteurAnnee As String

        Get
            If _NCtrlInspecteurAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_AutoControle_InspecteurAnnee / _NCtrlInspecteurAnnee) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_AutoControle_InspecteurTotal As String

        Get
            If _NCtrlInspecteurTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_AutoControle_InspecteurTotal / _NCtrlInspecteurTotal) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_PreControle_InspecteurAnnee As String

        Get
            If _NCtrlInspecteurAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_PreControle_InspecteurAnnee / _NCtrlInspecteurAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_PreControle_InspecteurTotal As String

        Get
            If _NCtrlInspecteurTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_PreControle_InspecteurTotal / _NCtrlInspecteurTotal) * 100, 2) & " %"
            End If


        End Get
    End Property
    Public ReadOnly Property PctCtrl_OK_StructureAnnee As String

        Get
            If _NCtrlStructureAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_OK_StructureAnnee / _NCtrlStructureAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_OK_StructureTotal As String

        Get
            If _NCtrlStructureTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_OK_StructureTotal / _NCtrlStructureTotal) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_CP_StructureAnnee As String

        Get
            If _NCtrlStructureAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_CP_StructureAnnee / _NCtrlStructureAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_CP_StructureTotal As String

        Get
            If _NCtrlStructureTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_CP_StructureTotal / _NCtrlStructureTotal) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_ReparAvant_StructureAnnee As String

        Get
            If _NCtrlStructureAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_ReparAvant_StructureAnnee / _NCtrlStructureAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_ReparAvant_StructureTotal As String

        Get
            If _NCtrlStructureTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_ReparAvant_StructureTotal / _NCtrlStructureTotal) * 100, 2) & " %"
            End If

        End Get
    End Property
    Public ReadOnly Property PctCtrl_AutoControle_StructureAnnee As String

        Get
            If _NCtrlStructureAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_AutoControle_StructureAnnee / _NCtrlStructureAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_AutoControle_StructureTotal As String

        Get
            If _NCtrlStructureTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_AutoControle_StructureTotal / _NCtrlStructureTotal) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_PreControle_StructureAnnee As String

        Get
            If _NCtrlStructureAnnee = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_PreControle_StructureAnnee / _NCtrlStructureAnnee) * 100, 2) & " %"
            End If
        End Get
    End Property
    Public ReadOnly Property PctCtrl_PreControle_StructureTotal As String

        Get
            If _NCtrlStructureTotal = 0 Then
                Return ""
            Else
                Return Math.Round((_NCtrl_PreControle_StructureTotal / _NCtrlStructureTotal) * 100, 2) & " %"
            End If
        End Get
    End Property

    Public Function Fill(ByVal pAgent As Agent, ByVal pAnneeReference As Integer) As Boolean
        Dim bReturn As Boolean
        Try
            Dim oCSDb As New CSDb(True)
            If CSDb._DBTYPE = CSDb.EnumDBTYPE.SQLITE Then
                NCtrlStructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where OrganismePresId = " & pAgent.idStructure & "")
                NCtrlInspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where inspecteurId = " & pAgent.id & "")

                NCtrlStructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrlInspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_OK_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_OK_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and inspecteurId = " & pAgent.id & "")

                NCtrl_OK_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_OK_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_CP_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_CP_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and inspecteurId = " & pAgent.id & "")

                NCtrl_CP_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_CP_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_ReparAvant_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_ReparAvant_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_ReparAvant_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_ReparAvant_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_AutoControle_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_AutoControle_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_AutoControle_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_AutoControle_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_PreControle_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_PreControle_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_PreControle_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and OrganismePresId = " & pAgent.idStructure & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_PreControle_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and inspecteurId = " & pAgent.id & " and strftime('%Y',controleDateDebut) = '" & pAnneeReference & "'")
            Else
                NCtrlStructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where OrganismePresId = " & pAgent.idStructure & "")
                NCtrlInspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where inspecteurId = " & pAgent.id & "")

                NCtrlStructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrlInspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_OK_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_OK_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and inspecteurId = " & pAgent.id & "")

                NCtrl_OK_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_OK_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat = '1' and inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_CP_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_CP_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and inspecteurId = " & pAgent.id & "")

                NCtrl_CP_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_CP_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where ControleEtat <> '1' and inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_ReparAvant_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_ReparAvant_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_ReparAvant_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_ReparAvant_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPulveRepare  = TRUE and inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_AutoControle_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_AutoControle_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_AutoControle_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_AutoControle_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsAutoControle  = TRUE and inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")

                NCtrl_PreControle_StructureTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and OrganismePresId = " & pAgent.idStructure & "")
                NCtrl_PreControle_InspecteurTotal = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and inspecteurId = " & pAgent.id & "")

                NCtrl_PreControle_StructureAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and OrganismePresId = " & pAgent.idStructure & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
                NCtrl_PreControle_InspecteurAnnee = oCSDb.getValue("SELECT count(*) from diagnostic where controleIsPreControleProfessionel  = TRUE and inspecteurId = " & pAgent.id & " and YEAR(controleDateDebut) = '" & pAnneeReference & "'")
            End If
            oCSDb.free()
            bReturn = True
        Catch ex As Exception
            CSDebug.dispError("StatCrodip.Fill Error : " & ex.Message)
            bReturn = False
        End Try
        Return bReturn
    End Function

End Class