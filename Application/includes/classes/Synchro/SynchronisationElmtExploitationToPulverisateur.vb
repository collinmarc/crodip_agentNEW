
Imports System.Web.Services
Imports System.Xml.Serialization
Imports System.Security.Cryptography
Imports System.IO
Imports System.Text
''' <summary>
''' SynchronisationElmtIdentifiantPulverisateur
''' Element de Synchronistation d'un Diagnostic
''' </summary>
''' <remarks></remarks>
Public Class SynchronisationElmtExploitationToPulverisateur
    Inherits SynchronisationElmt
    Public Sub New(pSynchroBoleans As SynchroBooleans)
        MyBase.New(getLabelGet(), pSynchroBoleans)
        IdentifiantEntier = 0
        IdentifiantChaine = ""
        ValeurAuxiliaire = ""
    End Sub
    'constructeur Sans paramètre utilisé uniquement pour la sérialisation
    Public Sub New()
        MyBase.New(getLabelGet(), New SynchroBooleans)
        IdentifiantEntier = 0
        IdentifiantChaine = ""
        ValeurAuxiliaire = ""
    End Sub

    Public Sub New(pIdDiag As String)
        MyBase.New(getLabelGet(), New SynchroBooleans)
        IdentifiantEntier = 0
        IdentifiantChaine = pIdDiag
        ValeurAuxiliaire = ""
    End Sub
    Public Shared Function getLabelGet() As String
        Return "GetExploitationTOPulverisateur"
    End Function
    Public Overrides Function SynchroDesc(pAgent As Agent) As Boolean
        Dim breturn As Boolean = False
        If (m_SynchroBoolean.m_bSynchDescPulve) Then
            Dim oExploitToPulve As ExploitationTOPulverisateur
            Try
                SetStatus("Réception MAJ Partages pulvés...")
                oExploitToPulve = ExploitationTOPulverisateurManager.getWSExploitationTOPulverisateurById(Me.IdentifiantChaine)
                ExploitationTOPulverisateurManager.save(oExploitToPulve, pAgent, True)
                breturn = True
            Catch ex As Exception
                CSDebug.dispFatal("Synchronisation::runDescSynchro(GetExploitationTOPulverisateur) : " & ex.Message.ToString)
                breturn = False
            End Try
        End If
        Return breturn
    End Function
End Class
