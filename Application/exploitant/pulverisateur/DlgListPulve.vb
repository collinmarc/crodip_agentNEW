Imports System.Windows.Forms
Imports CRODIPWS

Public Class DlgListPulve

    Private m_oExploit As Exploitation
    Public Sub setContexte(pExloit As Exploitation)
        m_oExploit = pExloit
    End Sub

    Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub

    Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
        Me.Close()
    End Sub

    Private Sub DlgListPulve_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        If m_oExploit IsNot Nothing Then
            Dim arrPulve As Pulverisateur() = PulverisateurManager.getPulverisateurByClientId(m_oExploit.id, agentCourant.DroitsPulves)
            For Each oPulve As Pulverisateur In arrPulve
                If Not oPulve.isPulveAdditionnel Then
                    m_bsrcPulve.Add(oPulve)
                End If
            Next
        End If
    End Sub

    Public Function getResult() As String
        Dim strReturn As String = ""
        If DataGridView1.SelectedRows.Count = 1 Then
            strReturn = CType(m_bsrcPulve.Current, Pulverisateur).numeroNational
        End If
        Return strReturn
    End Function

    Private Sub DataGridView1_MouseDoubleClick(sender As Object, e As MouseEventArgs) Handles DataGridView1.MouseDoubleClick
        Me.DialogResult = System.Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub
End Class
