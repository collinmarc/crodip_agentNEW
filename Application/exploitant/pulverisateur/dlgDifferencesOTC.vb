Imports System.Windows.Forms
Imports CRODIPWS

Public Class dlgDifferencesOTC

    Private m_pulve As Pulverisateur
    Public Sub setContexte(pPulve As Pulverisateur)
        m_pulve = pPulve
        Dim obList As New SortableBindingList(Of Anomalie)
        obList.AddList(m_pulve.lstAnomalie)
        mbs_Anomalies.DataSource = obList

    End Sub

    Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles OK_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.OK
        Me.Close()
    End Sub

    Private Sub Cancel_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Cancel_Button.Click
        Me.DialogResult = System.Windows.Forms.DialogResult.Cancel
        Me.Close()
    End Sub

    Private Sub ckValeurAgentTous_CheckedChanged(sender As Object, e As EventArgs) Handles ckValeurAgentTous.CheckedChanged
        If ckValeurAgentTous.Checked Then
            For Each oAno As Anomalie In m_pulve.lstAnomalie
                oAno.bValeurAgentOK = True
            Next
            ckValeurAgentTous.Checked = False
            mbs_Anomalies.ResetBindings(False)
        End If

    End Sub

    Private Sub ckValeurOTCTous_CheckedChanged(sender As Object, e As EventArgs) Handles ckValeurOTCTous.CheckedChanged
        If ckValeurOTCTous.Checked Then
            For Each oAno As Anomalie In m_pulve.lstAnomalie
                oAno.bvaleurOTCOK = True
            Next
            mbs_Anomalies.ResetBindings(False)
            ckValeurOTCTous.Checked = False
        End If
    End Sub


    Private Sub dgv_Anomalies_CellContentClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgv_Anomalies.CellContentClick
        dgv_Anomalies.EndEdit()
    End Sub
End Class
